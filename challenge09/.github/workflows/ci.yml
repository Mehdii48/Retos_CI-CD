name: CI Challenge 09 - Badges

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout cÃ³digo
      uses: actions/checkout@v3
    
    - name: Mostrar badge en README
      run: |
        echo "ğŸ›¡ï¸  Verificando badge en README..."
        if grep -q "badge.svg" README.md; then
          echo "âœ… Badge encontrado en README.md"
          echo "ğŸ“Š URL del badge:"
          grep -o 'https://[^)]*badge.svg' README.md
        else
          echo "âŒ No se encontrÃ³ badge en README.md"
          exit 1
        fi
    
    - name: Compilar programa
      run: |
        echo "ğŸ”¨ Compilando..."
        make build
        
    - name: Ejecutar programa
      run: |
        echo "ğŸš€ Probando programa..."
        ./programa
        
    - name: Ejecutar pruebas
      run: |
        echo "ğŸ§ª Ejecutando pruebas unitarias..."
        make test
        
    - name: Verificar estado
      if: success()
      run: |
        echo "ğŸ‰ Â¡PIPELINE COMPLETADO CON Ã‰XITO!"
        echo "âœ… El badge se actualizarÃ¡ automÃ¡ticamente a verde"
        
    - name: Notificar fallo
      if: failure()
      run: |
        echo "âŒ Â¡PIPELINE FALLÃ“!"
        echo "âš ï¸  El badge se actualizarÃ¡ automÃ¡ticamente a rojo"